# frozen_string_literal: true

require_relative "../schema_object"

# Source - The source of vulnerability information. This is often the organization that published the vulnerability.
module SBOM
  module CycloneDX
    class VulnerabilitySource < Struct.new(
      "VulnerabilitySource",
      # URL - The url of the vulnerability documentation as provided by the source.
      # Example: "https://nvd.nist.gov/vuln/detail/CVE-2021-39182"
      :url,
      # Name - The name of the source.
      # Examples: "NVD", "National Vulnerability Database", "OSS Index", "VulnDB", "GitHub Advisories"
      :name,
      keyword_init: true
    )
      include SchemaObject

      def valid?
        # Oddly, the schema does not validate the URL format here
        Validator.valid?(String, url) &&
          Validator.valid?(String, name)
      end
    end
  end
end
